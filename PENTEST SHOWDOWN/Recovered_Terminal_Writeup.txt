OFFICIAL CTF WRITE-UP
Recovered Terminal
Category: Reverse Engineering
Difficulty: Medium
File Provided: terminal.exe (Windows binary only)

------------------------------------------------------------
Challenge Description
------------------------------------------------------------
A damaged access terminal has been recovered from an unknown subsystem.
Some records appear unstable.
Some logs look valid — but are they?

------------------------------------------------------------
Objective
------------------------------------------------------------
Recover the correct flag from the binary.

------------------------------------------------------------
STEP 1 — Black-Box Testing
------------------------------------------------------------
Run the binary without any tools.

Observe:
- Output is deterministic
- Input content does not matter
- Input LENGTH matters
- Messages mention instability and alignment

Conclusion:
This is not a brute-force password challenge.
This is a logic and length-based challenge.

------------------------------------------------------------
STEP 2 — Length Pattern Discovery
------------------------------------------------------------
Test different input lengths.

Length 8  -> structured readable output (decoy)
Length 16 -> partially readable corrupted output
Length 18 -> different partial corruption
Others    -> garbage

Conclusion:
Specific input lengths unlock meaningful paths.

------------------------------------------------------------
STEP 3 — Open in Ghidra
------------------------------------------------------------
1. Open Ghidra
2. Create a new project
3. Import terminal.exe
4. Accept auto-analysis

------------------------------------------------------------
STEP 4 — Locate Entry Point
------------------------------------------------------------
Navigate:
Symbol Tree -> Functions -> main

Observe:
- Input read
- Length checks
- Multiple helper functions

------------------------------------------------------------
STEP 5 — Identify Noise
------------------------------------------------------------
You will see:
- Large byte arrays
- XOR-looking logic
- Dead functions

Rule:
If a function has no cross-references (XREFs), ignore it.
These are intentional noise.

------------------------------------------------------------
STEP 6 — Length-Based Branching
------------------------------------------------------------
Inside main, find conditions comparing input length.

Key lengths:
8
16
18

------------------------------------------------------------
STEP 7 — Decoy Path (Length 8)
------------------------------------------------------------
This path reconstructs believable output.
It is a trap.

Do NOT submit this result.

------------------------------------------------------------
STEP 8 — Real Data Path (Length 16 / 18)
------------------------------------------------------------
This path reconstructs the real encrypted archive.

------------------------------------------------------------
STEP 9 — Bytes to Dump
------------------------------------------------------------
Dump the following bytes in order:

1f 18 1a
1c 5f 2a 3d
29 6b 22
36 1a 68
39 28 30 6b
2f 2a 6d
36 3f 3d
28 68 24
34 3a 6e

------------------------------------------------------------
STEP 10 — How to Dump
------------------------------------------------------------
Option A: Runtime
- Breakpoint at output function
- Dump buffer before XOR

Option B: Static
- Copy bytes from Ghidra
- Reassemble manually

------------------------------------------------------------
STEP 11 — Decryption Logic
------------------------------------------------------------
Key formula:
key = (input_length * 7) ^ 0x5A

XOR each byte with the key.

Use length 16 and 18 to fix corrupted bytes.

------------------------------------------------------------
STEP 12 — Final Flag
------------------------------------------------------------
FLAG{par7i4l_l34k_x0r_m3dium}

------------------------------------------------------------
Common Mistakes
------------------------------------------------------------
- Submitting decoy output
- Brute forcing passwords
- Reversing unused functions
- Ignoring input length behavior

------------------------------------------------------------
Credits
------------------------------------------------------------
Recovered Terminal
Reverse Engineering Challenge

Created by: ETL Shadow
